<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Colony Builder</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* General body styling */
        body {
            margin: 0;
            overflow: hidden; /* Hide scrollbars */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a20, #0f1a30, #16213e); /* Dark space gradient */
            font-family: 'Inter', sans-serif;
            color: #e0e0e0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Game container styling */
        .game-container {
            position: relative;
            background-color: #0d0d1a; /* Darker background for the game area */
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 0 5px rgba(255, 255, 255, 0.05); /* Soft shadow and subtle border */
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            width: 95vw; /* Use a larger percentage of viewport width */
            height: 95vh; /* Use a larger percentage of viewport height */
            max-width: 1200px; 
            max-height: 800px; 
            box-sizing: border-box;
        }

        /* Canvas styling */
        canvas {
            background-color: #0d0d1a;
            display: block;
            border-radius: 10px;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.7); /* Inner shadow for depth */
            touch-action: none; /* Prevent default touch actions like scrolling/zooming */
            flex-grow: 1; /* Allow canvas to take up available space */
            width: 100%; /* Ensure canvas fills container width */
        }

        /* Info panel styling (score, health, wave, timer) */
        .info-panel {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 0 10px;
            box-sizing: border-box;
            flex-wrap: wrap; /* Allow wrapping for smaller screens */
        }

        .info-item {
            font-size: 1.8em;
            font-weight: 700;
            text-shadow: 0 0 8px rgba(255, 224, 102, 0.6);
            margin: 5px 10px; /* Spacing for wrapped items */
        }

        .asteroids-hit-display {
            color: #ffe066; /* Gold color for score (asteroids hit) */
        }

        .player-health-display {
            color: #ff6b6b; /* Red for player health */
        }

        .wave-display {
            color: #8be9fd; /* Light blue for wave */
        }

        .timer-display { /* New timer display style */
            color: #ffcc00; /* Yellow for timer */
            font-size: 1.8em;
            font-weight: 700;
            text-shadow: 0 0 8px rgba(255, 204, 0, 0.6);
        }

        .asteroids-leaked-display { /* New style for leaked asteroids */
            color: #ff4d4d; /* Light red for leaked asteroids */
            font-size: 1.8em;
            font-weight: 700;
            text-shadow: 0 0 8px rgba(255, 77, 77, 0.6);
        }

        /* Start and Game Over screen styling */
        .game-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center; /* Center vertically */
            align-items: center;
            color: #fff;
            font-size: 2em;
            text-align: center;
            border-radius: 20px;
            z-index: 10;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            padding: 20px; /* Add padding to prevent content touching edges */
            box-sizing: border-box; /* Include padding in width/height */
        }

        .game-screen.active {
            opacity: 1;
            visibility: visible;
        }

        .game-screen h1.title { 
            margin-bottom: 20px;
            font-size: 2.5em; 
            color: #8be9fd;
            text-shadow: 0 0 15px rgba(139, 233, 253, 0.7);
        }

        .game-screen h2 {
            margin-bottom: 15px;
            color: #ff6b6b; 
            font-size: 1.5em;
        }

        .game-screen h2.win { 
            color: #2ecc71; 
            text-shadow: 0 0 15px rgba(46, 204, 113, 0.7);
        }

        .game-screen p {
            margin-bottom: 25px;
            font-size: 0.8em;
            color: #e0e0e0;
            max-width: 80%; 
            line-height: 1.5;
            overflow-y: auto; 
            max-height: 40%; 
        }

        
        .action-button {
            background-color: #4CAF50; 
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
            font-weight: 700;
            margin: 10px; 
        }

        .action-button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.6);
        }

        .action-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
        }

       
        .difficulty-buttons {
            display: flex;
            flex-wrap: wrap; 
            justify-content: center;
            margin-top: 20px;
            gap: 15px; 
        }

        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
            z-index: 1000;
            display: none; 
            flex-direction: column;
            align-items: center;
            text-align: center;
            max-width: 80vw;
        }

        .message-box h3 {
            margin-top: 0;
            color: #3498db;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .message-box p {
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .message-box button {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .message-box button:hover {
            background-color: #2980b9;
        }

        
        @media (max-width: 768px) {
            .game-container {
                padding: 10px; 
            .info-panel {
                flex-direction: column;
                gap: 5px; 
                margin-bottom: 10px;
            }
            .info-item {
                font-size: 1.1em; 
                margin: 3px 5px;
            }
            .timer-display {
                font-size: 1.1em;
            }
            .asteroids-leaked-display {
                font-size: 1.1em;
            }
            .game-screen {
                font-size: 1.2em; 
                padding: 15px;
            }
            .game-screen h1.title {
                font-size: 2em; 
            }
            .game-screen h2 {
                font-size: 1.3em;
            }
            .game-screen p {
                font-size: 0.7em;
                margin-bottom: 15px;
                max-width: 90%; 
                max-height: 50%; 
            }
            .action-button {
                padding: 8px 18px;
                font-size: 0.9em;
                margin: 8px;
            }
            .difficulty-buttons {
                gap: 10px; 
            }
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 5px;
            }
            .info-item {
                font-size: 1em;
            }
            .timer-display {
                font-size: 1em;
            }
            .asteroids-leaked-display {
                font-size: 1em;
            }
            .game-screen h1.title {
                font-size: 1.8em;
            }
            .game-screen p {
                font-size: 0.65em;
                max-height: 60%; 
            }
            .action-button {
                padding: 6px 15px;
                font-size: 0.8em;
                margin: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="info-panel">
            <div class="info-item asteroids-hit-display">Asteroids Hit: <span id="asteroidsHitCount">0</span></div>
            <div class="info-item wave-display">Wave: <span id="waveNumber">1</span></div>
            <div class="info-item player-health-display">Ship Health: <span id="playerHealth">100</span></div>
            <div class="info-item timer-display">Time: <span id="gameTimerDisplay">00:00</span></div> 
            <div class="info-item asteroids-leaked-display">Leaked: <span id="asteroidsLeakedCount">0</span>/<span id="maxAsteroidLeaksDisplay">5</span></div>
        </div>
        <canvas id="gameCanvas"></canvas>

        
        <div id="startScreen" class="game-screen active">
            <h1 class="title">Space Colony Builder</h1>
            <p class="instructions">
                **Objective:** Hit at least 30 asteroids within 1 minute to win!
                <br>Don't let more than <span id="startScreenMaxLeaks">3</span> asteroids escape!
                <br><br>
                Mine asteroids for ore! Protect your ship from collisions.
                <br><br>
                **Controls:**
                <br>Move Ship: Left/Right Arrow Keys or A/D
                <br>Shoot: Pointer (Click/Tap)
                <br>Mine Asteroids: Fly close to them (within mining range)
                <br><br>
                Don't let your ship get destroyed!
            </p>
            <div class="difficulty-buttons">
                <button class="action-button" id="easyButton">Easy</button>
                <button class="action-button" id="mediumButton">Medium</button>
                <button class="action-button" id="hardButton">Hard</button>
            </div>
        </div>

        
        <div id="gameOverScreen" class="game-screen">
            <h2 id="gameOverTitle">Game Over!</h2> 
            <p>Asteroids Hit: <span id="finalAsteroidsHit">0</span></p>
            <p>Asteroids Leaked: <span id="finalAsteroidsLeaked">0</span></p>
            <p>You reached Wave: <span id="finalWave">1</span></p>
            <p id="gameOverReason"></p>
            <button class="action-button" id="restartButton">Restart Game</button>
        </div>
    </div>

    
    <div id="messageBox" class="message-box">
        <h3 id="messageBoxTitle"></h3>
        <p id="messageBoxContent"></p>
        <button id="messageBoxClose">OK</button>
    </div>

    <script>
        
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const asteroidsHitCountDisplay = document.getElementById('asteroidsHitCount');
        const playerHealthDisplay = document.getElementById('playerHealth');
        const waveNumberDisplay = document.getElementById('waveNumber');
        const gameTimerDisplay = document.getElementById('gameTimerDisplay'); 
        const asteroidsLeakedCountDisplay = document.getElementById('asteroidsLeakedCount'); 
        const maxAsteroidLeaksDisplay = document.getElementById('maxAsteroidLeaksDisplay'); 
        const startScreenMaxLeaks = document.getElementById('startScreenMaxLeaks'); 
        const startScreen = document.getElementById('startScreen');
        const easyButton = document.getElementById('easyButton');
        const mediumButton = document.getElementById('mediumButton');
        const hardButton = document.getElementById('hardButton');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const gameOverTitle = document.getElementById('gameOverTitle'); 
        const finalAsteroidsHitDisplay = document.getElementById('finalAsteroidsHit');
        const finalAsteroidsLeakedDisplay = document.getElementById('finalAsteroidsLeaked'); 
        const finalWaveDisplay = document.getElementById('finalWave');
        const gameOverReasonDisplay = document.getElementById('gameOverReason');
        const restartButton = document.getElementById('restartButton');

       
        const messageBox = document.getElementById('messageBox');
        const messageBoxTitle = document.getElementById('messageBoxTitle');
        const messageBoxContent = document.getElementById('messageBoxContent');
        const messageBoxClose = document.getElementById('messageBoxClose');

        
        let player;
        let projectiles = []; 
        let asteroids = [];
        let oreDeposits = []; 
        let particles = []; 
        let stars = []; 
        let asteroidsHit; 
        let asteroidsLeaked; 
        let maxAsteroidLeaks; 
        let gameFrame;
        let gameOver;
        let keys = {}; 
        let mouse = { x: 0, y: 0, pressed: false }; 

        let gameTimer; 
        const GAME_TIME_LIMIT = 60; 
        const ASTEROIDS_TO_WIN = 30; 
       
        const GAME_STATE = {
            START: 'START',
            PLAYING: 'PLAYING',
            GAME_OVER: 'GAME_OVER'
        };
        let currentGameState = GAME_STATE.START;
        let selectedDifficulty = 'medium'; 

       
        let waveNumber;
        let waveSpawnInterval; 
        let waveStartTime; 
        let waveDuration; 

        const FPS = 60; 
        const WAVE_DURATION_SECONDS = 300; 
        const BASE_WAVE_DURATION_FRAMES = WAVE_DURATION_SECONDS * FPS;

        
        const WAVE_CONFIGS = {
            easy: [
                { spawnInterval: 150, asteroidSpeed: 0.4, playerMaxHealth: 150, asteroidDamage: 10, maxAsteroidLeaks: 7 }, // Wave 1 (Reduced from 10 to 7)
                { spawnInterval: 120, asteroidSpeed: 0.5, playerMaxHealth: 150, asteroidDamage: 10, maxAsteroidLeaks: 7 }, // Wave 2
                { spawnInterval: 100, asteroidSpeed: 0.6, playerMaxHealth: 150, asteroidDamage: 10, maxAsteroidLeaks: 7 }, // Wave 3
                { spawnInterval: 80, asteroidSpeed: 0.7, playerMaxHealth: 150, asteroidDamage: 10, maxAsteroidLeaks: 7 }, // Wave 4
                { spawnInterval: 70, asteroidSpeed: 0.8, playerMaxHealth: 150, asteroidDamage: 10, maxAsteroidLeaks: 7 }, // Wave 5
            ],
            medium: [
                { spawnInterval: 140, asteroidSpeed: 0.5, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 1 (Reduced from 5 to 3)
                { spawnInterval: 110, asteroidSpeed: 0.6, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 2
                { spawnInterval: 90, asteroidSpeed: 0.7, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 3
                { spawnInterval: 70, asteroidSpeed: 0.8, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 4
                { spawnInterval: 60, asteroidSpeed: 0.9, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 5
                { spawnInterval: 50, asteroidSpeed: 1.0, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 6
                { spawnInterval: 45, asteroidSpeed: 1.1, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 7
                { spawnInterval: 40, asteroidSpeed: 1.2, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 8
                { spawnInterval: 35, asteroidSpeed: 1.3, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }, // Wave 9
                { spawnInterval: 30, asteroidSpeed: 1.4, playerMaxHealth: 100, asteroidDamage: 15, maxAsteroidLeaks: 3 }  // Wave 10 (and beyond, scales up)
            ],
            hard: [
                { spawnInterval: 120, asteroidSpeed: 0.6, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 1 (Reduced from 3 to 2)
                { spawnInterval: 100, asteroidSpeed: 0.7, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 2
                { spawnInterval: 80, asteroidSpeed: 0.8, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 3
                { spawnInterval: 60, asteroidSpeed: 0.9, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 4
                { spawnInterval: 50, asteroidSpeed: 1.0, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 5
                { spawnInterval: 40, asteroidSpeed: 1.1, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 6
                { spawnInterval: 35, asteroidSpeed: 1.2, playerMaxHealth: 75, asteroidDamage: 20, maxAsteroidLeaks: 2 }, // Wave 7
            ]
        };

       
        const PLAYER_SIZE = 20;
        const PLAYER_SPEED = 4;
        const PLAYER_FIRE_RATE = 20; 
        const PROJECTILE_RADIUS = 3;
        const PROJECTILE_SPEED = 8;

        const ASTEROID_RADIUS_MIN = 20;
        const ASTEROID_RADIUS_MAX = 40;
        const ASTEROID_HEALTH_MULTIPLIER = 0.5; 
        const ASTEROID_MINING_RANGE = 60; 

        const ORE_SIZE = 5;
        const ORE_VALUE = 1; 

        const PARTICLE_COLORS_ASTEROID = ['#a0a0a0', '#c0c0c0', '#808080', '#606060']; // Grey/rock colors
        const PARTICLE_COLORS_ORE = ['#f39c12', '#e67e22', '#d35400']; // Orange/gold for ore particles
        const STAR_COLORS = ['#ffffff', '#f0f0f0', '#e0e0e0'];
        const CONFETTI_COLORS = ['#FFC0CB', '#FFD700', '#ADFF2F', '#00FFFF', '#FF69B4', '#EE82EE']; // Pink, Gold, GreenYellow, Cyan, HotPink, Violet

     
        function showMessageBox(title, message) {
            messageBoxTitle.textContent = title;
            messageBoxContent.textContent = message;
            messageBox.style.display = 'flex';
        }

        
        messageBoxClose.addEventListener('click', () => {
            messageBox.style.display = 'none';
        });

       
        function resizeCanvas() {
            canvas.width = Math.min(window.innerWidth * 0.95, 1200); 
            canvas.height = Math.min(window.innerHeight * 0.8, 800); 

            
            stars = [];
            for (let i = 0; i < 200; i++) { 
                stars.push(new Star());
            }

            
            if (player) {
                player.x = canvas.width / 2;
                player.y = canvas.height - PLAYER_SIZE / 2 - 10;
            }
        }

        
        window.addEventListener('resize', resizeCanvas);

       
        function checkCircleCollision(obj1, obj2) {
            const dx = obj1.x - obj2.x;
            const dy = obj1.y - obj2.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            return distance < obj1.radius + obj2.radius;
        }

      
        function distance(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }

       
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = Math.floor(totalSeconds % 60);
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        

        
        class Player {
            constructor() {
                this.x = canvas.width / 2;
                
                this.y = canvas.height - PLAYER_SIZE / 2 - 10; 
                this.radius = PLAYER_SIZE / 2;
                this.color = '#3498db'; 
                this.speed = PLAYER_SPEED;
                this.lastShotFrame = 0;
                this.fireRate = PLAYER_FIRE_RATE;
                this.maxHealth = 100; 
                this.health = this.maxHealth;
            }

            
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                
                ctx.beginPath();
                ctx.moveTo(0, -this.radius * 1.5); 
                ctx.lineTo(-this.radius, this.radius); 
                ctx.lineTo(this.radius, this.radius); 
                ctx.closePath();
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.strokeStyle = '#2980b9';
                ctx.lineWidth = 2;
                ctx.stroke();

                
                const exhaustLength = this.radius * (1 + Math.sin(gameFrame * 0.2) * 0.3);
                ctx.beginPath();
                ctx.moveTo(-this.radius * 0.6, this.radius);
                ctx.lineTo(0, this.radius + exhaustLength);
                ctx.lineTo(this.radius * 0.6, this.radius);
                ctx.closePath();
                ctx.fillStyle = `rgba(255, 165, 0, ${0.7 + Math.sin(gameFrame * 0.3) * 0.3})`; 
                ctx.fill();
                ctx.restore();
            }

           
            update() {
                
                if (keys['arrowleft'] || keys['a']) this.x -= this.speed;
                if (keys['arrowright'] || keys['d']) this.x += this.speed;

                
                if (this.x < this.radius) this.x = this.radius;
                if (this.x > canvas.width - this.radius) this.x = canvas.width - this.radius;

                
                this.y = canvas.height - PLAYER_SIZE / 2 - 10;
            }

            
            shoot(targetX, targetY) {
                if (gameFrame - this.lastShotFrame > this.fireRate) {
                 
                    const dx = targetX - this.x;
                    const dy = targetY - this.y; 
                    const angle = Math.atan2(dy, dx);

                    
                    const actualAngle = targetY > this.y ? -Math.PI / 2 : angle;
                    
                    const velocityX = Math.cos(actualAngle) * PROJECTILE_SPEED;
                    const velocityY = Math.sin(actualAngle) * PROJECTILE_SPEED;
                    
                    projectiles.push(new Projectile(this.x, this.y, PROJECTILE_RADIUS, velocityX, velocityY));
                    this.lastShotFrame = gameFrame;
                }
            }

           
            takeDamage(damage) {
                this.health -= damage;
                if (this.health < 0) this.health = 0;
                playerHealthDisplay.textContent = this.health;
            }
        }

       
        class Projectile {
            constructor(x, y, radius, velocityX, velocityY) {
                this.x = x;
                this.y = y;
                this.radius = radius;
                this.velocityX = velocityX;
                this.velocityY = velocityY;
                this.color = '#ffcc00'; 
            }

          
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
            }

           
            update() {
                this.x += this.velocityX;
                this.y += this.velocityY;
            }
        }

        
        class Asteroid {
            constructor(x, y, radius, velocityX, velocityY) {
                this.x = x;
                this.y = y;
                this.radius = radius;
                this.velocityX = velocityX;
                this.velocityY = velocityY;
                this.color = '#8b4513'; 
                this.initialHealth = Math.ceil(radius * ASTEROID_HEALTH_MULTIPLIER);
                this.health = this.initialHealth;
                this.isMining = false; 
            }

            
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.strokeStyle = '#6e350f';
                ctx.lineWidth = 2;
                ctx.stroke();

                
                const barWidth = this.radius * 1.5;
                const barHeight = 3;
                const barX = this.x - barWidth / 2;
                const barY = this.y - this.radius - barHeight - 5;
                const currentHealthWidth = (this.health / this.initialHealth) * barWidth;

                ctx.fillStyle = 'rgba(51, 51, 51, 0.8)'; 
                ctx.fillRect(barX, barY, barWidth, barHeight);
                ctx.fillStyle = '#27ae60'; 
                ctx.fillRect(barX, barY, currentHealthWidth, barHeight);
                ctx.strokeStyle = 'rgba(46, 204, 113, 0.8)';
                ctx.lineWidth = 1;
                ctx.strokeRect(barX, barY, barWidth, barHeight);

                
                if (this.isMining) {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius + 5, 0, Math.PI * 2);
                    ctx.strokeStyle = `rgba(0, 255, 255, ${0.5 + Math.sin(gameFrame * 0.1) * 0.2})`; 
                    ctx.lineWidth = 3;
                    ctx.stroke();
                }
            }

           
            update() {
                this.x += this.velocityX;
                this.y += this.velocityY;
            }

            
            mine(amount) {
                this.health -= amount;
                return this.health <= 0;
            }
        }

        
        class OreDeposit {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.radius = ORE_SIZE / 2;
                this.color = '#f39c12'; 
                this.life = 300; 
            }

            
            draw() {
                ctx.beginPath();
                ctx.rect(this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2); // Square shape
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.strokeStyle = '#e67e22';
                ctx.lineWidth = 1;
                ctx.stroke();
            }

           
            update() {
                
                this.x += (Math.random() - 0.5) * 0.5;
                this.y += (Math.random() - 0.5) * 0.5;
                this.life--;
                this.opacity = this.life / 300; 
                if (this.opacity < 0) this.opacity = 0; 
                ctx.globalAlpha = this.opacity; 
            }
        }

        
        class Particle {
            constructor(x, y, size, color, velocityX, velocityY, life, shape = 'circle') {
                this.x = x;
                this.y = y;
                this.size = size;
                this.color = color;
                this.velocityX = velocityX;
                this.velocityY = velocityY;
                this.life = life; 
                this.opacity = 1;
                this.shape = shape; 
                this.rotation = Math.random() * Math.PI * 2; 
                this.rotationSpeed = (Math.random() - 0.5) * 0.2; 
            }

           
            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity;
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);

                if (this.shape === 'circle') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = this.color;
                    ctx.fill();
                } else if (this.shape === 'rect') {
                    ctx.fillStyle = this.color;
                    ctx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size);
                }
                ctx.restore();
            }

            
            update() {
                this.x += this.velocityX;
                this.y += this.velocityY;
                this.life--;
                this.opacity = this.life / 60; 
                this.rotation += this.rotationSpeed; 
            }
        }

        
        class Star {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 1.5 + 0.5; 
                this.opacity = Math.random(); 
                this.speed = Math.random() * 0.2 + 0.05; 
                this.twinkleOffset = Math.random() * Math.PI * 2; 
                this.color = STAR_COLORS[Math.floor(Math.random() * STAR_COLORS.length)];
            }

           
            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity + Math.sin(gameFrame * 0.05 + this.twinkleOffset) * 0.3; 
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }

           
            update() {
                this.x -= this.speed;
                if (this.x < -this.size) {
                    this.x = canvas.width + this.size;
                    this.y = Math.random() * canvas.height;
                }
            }
        }

        

        
        function initGame() {
            resizeCanvas(); 
            player = new Player();
            projectiles = [];
            asteroids = [];
            oreDeposits = [];
            particles = [];
            stars = []; 
            asteroidsHit = 0; 
            asteroidsLeaked = 0; 
            maxAsteroidLeaks = 3; 
            gameFrame = 0;
            gameOver = false;
            waveNumber = 0; 
            keys = {}; 

            gameTimer = GAME_TIME_LIMIT; 

           
            for (let i = 0; i < 200; i++) {
                stars.push(new Star());
            }

            
            asteroidsHitCountDisplay.textContent = asteroidsHit;
            playerHealthDisplay.textContent = player.health;
            waveNumberDisplay.textContent = waveNumber;
            gameTimerDisplay.textContent = formatTime(gameTimer); 
            asteroidsLeakedCountDisplay.textContent = asteroidsLeaked; 
            maxAsteroidLeaksDisplay.textContent = maxAsteroidLeaks; 
            startScreenMaxLeaks.textContent = maxAsteroidLeaks; 

       
            gameOverScreen.classList.remove('active');
            startScreen.classList.add('active');
            gameOverTitle.classList.remove('win'); 

            currentGameState = GAME_STATE.START;
        }

     
       
        function createConfetti(x, y, count) {
            for (let i = 0; i < count; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 5 + 2; 
                const size = Math.random() * 8 + 5; 
                const life = Math.random() * 90 + 60; 
                const color = CONFETTI_COLORS[Math.floor(Math.random() * CONFETTI_COLORS.length)];
                particles.push(new Particle(x, y, size, color, Math.cos(angle) * speed, Math.sin(angle) * speed, life, 'rect'));
            }
        }

        
        function startNextWave() {
            const previousWave = waveNumber;
            waveNumber++;
            waveNumberDisplay.textContent = waveNumber;
            waveStartTime = gameFrame; 

            
            const currentWaveConfigSet = WAVE_CONFIGS[selectedDifficulty];
            const configIndex = Math.min(waveNumber - 1, currentWaveConfigSet.length - 1);
            const waveConfig = currentWaveConfigSet[configIndex];

            waveSpawnInterval = waveConfig.spawnInterval;
            maxAsteroidLeaks = waveConfig.maxAsteroidLeaks; 

            
            if (previousWave === 0) {
                player.maxHealth = waveConfig.playerMaxHealth;
                player.health = player.maxHealth;
                playerHealthDisplay.textContent = player.health;
            }
            asteroidsLeakedCountDisplay.textContent = asteroidsLeaked; 
            maxAsteroidLeaksDisplay.textContent = maxAsteroidLeaks; 

            
            if (previousWave > 0) {
                showMessageBox(`Wave ${previousWave} Cleared!`, `Prepare for Wave ${waveNumber} and new challenges!`);
                createConfetti(canvas.width / 2, canvas.height / 2, 50); 
            } else {
                
                showMessageBox(`Wave ${waveNumber} Incoming!`, `Destroy asteroids!`);
            }
        }

        
        function endGame(didWin, reason) {
            gameOver = true;
            currentGameState = GAME_STATE.GAME_OVER;
            finalAsteroidsHitDisplay.textContent = asteroidsHit;
            finalAsteroidsLeakedDisplay.textContent = asteroidsLeaked; 
            finalWaveDisplay.textContent = waveNumber;
            gameOverReasonDisplay.textContent = `Reason: ${reason}`;
            gameOverScreen.classList.add('active');

            if (didWin) {
                gameOverTitle.textContent = "You Win!";
                gameOverTitle.classList.add('win');
                showMessageBox("Victory!", `Congratulations! You hit ${asteroidsHit} asteroids and won!`);
                createConfetti(canvas.width / 2, canvas.height / 2, 100); 
            } else {
                gameOverTitle.textContent = "Game Over!";
                gameOverTitle.classList.remove('win');
                showMessageBox("You Lost!", `You destroyed ${asteroidsHit} asteroids and reached Wave ${waveNumber}. ${reason}`);
            }
        }

   

        
        function spawnEntities() {
            const currentWaveConfigSet = WAVE_CONFIGS[selectedDifficulty];
            const configIndex = Math.min(waveNumber - 1, currentWaveConfigSet.length - 1);
            const waveConfig = currentWaveConfigSet[configIndex];

           
            
            if (gameFrame % waveSpawnInterval === 0) {
                const speed = (Math.random() * 0.5 + 0.5) * waveConfig.asteroidSpeed; 
                const radius = Math.random() * (ASTEROID_RADIUS_MAX - ASTEROID_RADIUS_MIN) + ASTEROID_RADIUS_MIN;

                
                let x, y, vx, vy;
                const edge = Math.floor(Math.random() * 4); 

                
                const targetX = canvas.width / 2;
                const targetY = canvas.height; 

                if (edge === 0) { x = Math.random() * canvas.width; y = -radius; vx = (targetX - x) * 0.005 * speed; vy = speed; }
                else if (edge === 1) { x = canvas.width + radius; y = Math.random() * canvas.height; vx = -speed; vy = (targetY - y) * 0.005 * speed; }
                else if (edge === 2) { x = Math.random() * canvas.width; y = canvas.height + radius; vx = (targetX - x) * 0.005 * speed; vy = -speed; }
                else { x = -radius; y = Math.random() * canvas.height; vx = speed; vy = (targetY - y) * 0.005 * speed; }

                asteroids.push(new Asteroid(x, y, radius, vx, vy));
            }
        }

       
        function createExplosion(x, y, numParticles, colors) {
            for (let i = 0; i < numParticles; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 4 + 1; 
                const size = Math.random() * 2 + 1; 
                const life = Math.random() * 50 + 20; 
                const color = colors[Math.floor(Math.random() * colors.length)];
                particles.push(new Particle(x, y, size, color, Math.cos(angle) * speed, Math.sin(angle) * speed, life));
            }
        }

       
        function dropOre(x, y, amount) {
            for (let i = 0; i < amount; i++) {
                oreDeposits.push(new OreDeposit(x, y));
            }
        }

        
        function createMiningParticles(x, y) {
            if (gameFrame % 5 === 0) { 
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 2 + 0.5;
                const size = Math.random() * 1.5 + 0.5;
                const life = 30;
                const color = PARTICLE_COLORS_ORE[Math.floor(Math.random() * PARTICLE_COLORS_ORE.length)];
                particles.push(new Particle(x, y, size, color, Math.cos(angle) * speed, Math.sin(angle) * speed, life));
            }
        }

        

        
        function animate() {
            requestAnimationFrame(animate);

            
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            
            for (let i = 0; i < stars.length; i++) {
                stars[i].update();
                stars[i].draw();
            }

           
            switch (currentGameState) {
                case GAME_STATE.START:
                    
                    break;

                case GAME_STATE.PLAYING:
                    
                    if (gameFrame % FPS === 0) { 
                        gameTimer--;
                        gameTimerDisplay.textContent = formatTime(gameTimer);
                    }

                    
                    if (gameTimer <= 0) {
                        if (asteroidsHit >= ASTEROIDS_TO_WIN) {
                            endGame(true, `You hit ${asteroidsHit} asteroids within the time limit!`);
                        } else {
                            endGame(false, `Time ran out! You only hit ${asteroidsHit} of ${ASTEROIDS_TO_WIN} asteroids.`);
                        }
                        return; 
                    }

                    
                    if (asteroidsLeaked >= maxAsteroidLeaks) {
                        endGame(false, `Too many asteroids leaked! (${asteroidsLeaked}/${maxAsteroidLeaks})`);
                        return;
                    }

                    
                    player.update();
                    player.draw();

                    
                    for (let i = 0; i < projectiles.length; i++) {
                        projectiles[i].update();
                        projectiles[i].draw();

                        
                        if (projectiles[i].x < -projectiles[i].radius ||
                            projectiles[i].x > canvas.width + projectiles[i].radius ||
                            projectiles[i].y < -projectiles[i].radius ||
                            projectiles[i].y > canvas.height + projectiles[i].radius) {
                            projectiles.splice(i, 1);
                            i--;
                        }
                    }

                    
                    spawnEntities(); 
                    for (let i = 0; i < asteroids.length; i++) {
                        const asteroid = asteroids[i];
                        asteroid.update();
                        asteroid.draw();

                        
                        if (asteroid.y - asteroid.radius > canvas.height) {
                            asteroidsLeaked++;
                            asteroidsLeakedCountDisplay.textContent = asteroidsLeaked;
                            asteroids.splice(i, 1);
                            i--;
                            continue; 
                        }
                        
                        if (asteroid.x + asteroid.radius < 0 ||
                            asteroid.x - asteroid.radius > canvas.width ||
                            asteroid.y + asteroid.radius < 0) { 
                            asteroids.splice(i, 1);
                            i--;
                            continue;
                        }

                        
                        const distToPlayer = distance(player.x, player.y, asteroid.x, asteroid.y);
                        if (distToPlayer < asteroid.radius + ASTEROID_MINING_RANGE) {
                            asteroid.isMining = true;
                            createMiningParticles(asteroid.x, asteroid.y);
                            if (asteroid.mine(0.05)) { 
                                dropOre(asteroid.x, asteroid.y, Math.floor(asteroid.initialHealth / 2)); 
                                createExplosion(asteroid.x, asteroid.y, 20, PARTICLE_COLORS_ASTEROID); 
                                asteroids.splice(i, 1); 
                                i--; 
                                continue; 
                            }
                        } else {
                            asteroid.isMining = false;
                        }

                        
                        if (checkCircleCollision(player, asteroid)) {
                            const currentWaveConfigSet = WAVE_CONFIGS[selectedDifficulty];
                            const configIndex = Math.min(waveNumber - 1, currentWaveConfigSet.length - 1);
                            const waveConfig = currentWaveConfigSet[configIndex];
                            player.takeDamage(waveConfig.asteroidDamage); 
                            createExplosion(asteroid.x, asteroid.y, 15, PARTICLE_COLORS_ASTEROID); 
                            asteroids.splice(i, 1);
                            i--;
                            if (player.health <= 0) {
                                endGame(false, "Your ship was destroyed by an asteroid!");
                                return;
                            }
                            continue; 
                        }


                        
                        for (let j = 0; j < projectiles.length; j++) {
                            if (checkCircleCollision(asteroid, projectiles[j])) {
                                if (asteroid.mine(1)) { 
                                    asteroidsHit++; 
                                    asteroidsHitCountDisplay.textContent = asteroidsHit;
                                    dropOre(asteroid.x, asteroid.y, Math.floor(asteroid.initialHealth / 2));
                                    createExplosion(asteroid.x, asteroid.y, 20, PARTICLE_COLORS_ASTEROID);
                                    asteroids.splice(i, 1);
                                    projectiles.splice(j, 1);
                                    i--;
                                    break;
                                } else {
                                    createExplosion(projectiles[j].x, projectiles[j].y, 5, ['#ffcc00']);
                                    projectiles.splice(j, 1);
                                    break;
                                }
                            }
                        }
                    }

                    
                    for (let i = 0; i < oreDeposits.length; i++) {
                        oreDeposits[i].update();
                        oreDeposits[i].draw();

                        
                        if (checkCircleCollision(player, oreDeposits[i])) {
                            asteroidsHit += ORE_VALUE; 
                            asteroidsHitCountDisplay.textContent = asteroidsHit;
                            oreDeposits.splice(i, 1);
                            i--;
                        } else if (oreDeposits[i].life <= 0 || oreDeposits[i].y > canvas.height + oreDeposits[i].radius) {
                            
                            oreDeposits.splice(i, 1);
                            i--;
                        }
                    }

                    
                    if (gameFrame - waveStartTime >= BASE_WAVE_DURATION_FRAMES) {
                        startNextWave(); // Move to the next wave
                    }

                   
                    for (let i = 0; i < particles.length; i++) {
                        particles[i].update();
                        particles[i].draw();
                        if (particles[i].life <= 0) {
                            particles.splice(i, 1);
                            i--;
                        }
                    }

                    gameFrame++; 
                    break;

                case GAME_STATE.GAME_OVER:
                    
                    break;
            }
        }

        

        
        window.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouse.x = e.clientX - rect.left;
            mouse.y = e.clientY - rect.top;
        });

        canvas.addEventListener('mousedown', (e) => {
            if (currentGameState === GAME_STATE.PLAYING) {
                mouse.pressed = true;
                player.shoot(mouse.x, mouse.y); 
            }
        });

        canvas.addEventListener('mouseup', () => {
            mouse.pressed = false;
        });

        
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault(); 
            if (currentGameState === GAME_STATE.PLAYING) {
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                mouse.x = touch.clientX - rect.left;
                mouse.y = touch.clientY - rect.top;
                mouse.pressed = true;
                player.shoot(mouse.x, mouse.y); 
            }
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault(); 
            if (currentGameState === GAME_STATE.PLAYING && e.touches.length > 0) {
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                
                mouse.x = touch.clientX - rect.left;
                mouse.y = touch.clientY - rect.top;
            }
        });

        canvas.addEventListener('touchend', () => {
            mouse.pressed = false;
        });

        
        easyButton.addEventListener('click', () => {
            selectedDifficulty = 'easy';
            startScreen.classList.remove('active');
            currentGameState = GAME_STATE.PLAYING;
            initGameForDifficulty(); 
        });

        mediumButton.addEventListener('click', () => {
            selectedDifficulty = 'medium';
            startScreen.classList.remove('active');
            currentGameState = GAME_STATE.PLAYING;
            initGameForDifficulty(); 
        });

        hardButton.addEventListener('click', () => {
            selectedDifficulty = 'hard';
            startScreen.classList.remove('active');
            currentGameState = GAME_STATE.PLAYING;
            initGameForDifficulty(); 
        });

        
        restartButton.addEventListener('click', () => {
            initGame(); 
            
        });

       
        function initGameForDifficulty() {
            resizeCanvas(); 
            player = new Player();
            projectiles = [];
            asteroids = [];
            oreDeposits = [];
            particles = [];
            stars = []; 
            asteroidsHit = 0; 
            asteroidsLeaked = 0; 
            gameFrame = 0;
            gameOver = false;
            waveNumber = 0; 
            keys = {}; 

            gameTimer = GAME_TIME_LIMIT; 

          
            const initialWaveConfig = WAVE_CONFIGS[selectedDifficulty][0];
            player.maxHealth = initialWaveConfig.playerMaxHealth;
            player.health = player.maxHealth;
            maxAsteroidLeaks = initialWaveConfig.maxAsteroidLeaks; 

            
            for (let i = 0; i < 200; i++) {
                stars.push(new Star());
            }

            
            asteroidsHitCountDisplay.textContent = asteroidsHit;
            playerHealthDisplay.textContent = player.health;
            waveNumberDisplay.textContent = waveNumber; 
            gameTimerDisplay.textContent = formatTime(gameTimer); 
            asteroidsLeakedCountDisplay.textContent = asteroidsLeaked; 
            maxAsteroidLeaksDisplay.textContent = maxAsteroidLeaks; 

            gameOverScreen.classList.remove('active');
            gameOverTitle.classList.remove('win'); 
            startNextWave(); 
        }

        
        window.onload = async function() {
            initGame(); 
            animate(); 
        };
    </script>
</body>
</html>
<!DOCTYPE html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      